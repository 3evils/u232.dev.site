var openobj,closedobj,formobj,statobj,mainobj,open_div="poll-box-open",closed_div="poll-box-closed",stat_div="poll-box-stat",main_div="poll-box-main",form_id="postingform",used_questions=0;function poll_init_state(){openobj=document.getElementById(open_div),closedobj=document.getElementById(closed_div),formobj=document.getElementById(form_id),statobj=document.getElementById(stat_div),mainobj=document.getElementById(main_div),showfullonload?(my_show_div(openobj),my_hide_div(closedobj)):(my_show_div(closedobj),my_hide_div(openobj)),poll_draw_main_box()}function my_hide_div(o){o&&(o.style.display="none")}function my_show_div(o){o&&(o.style.display="")}function lang_build_string(){if(arguments.length&&arguments){for(var o=arguments[0],l=1;l<arguments.length;l++){var _=new RegExp("<%"+l+">","gi");o=o.replace(_,arguments[l])}return o}}function poll_draw_main_box(){var o="";for(var l in used_questions=0,poll_questions){var _="";used_questions++;var e=poll_questions[l],n="";for(var t in poll_multi)t==l&&1==poll_multi[t]&&(n="checked='checked'");_+="\n"+lang_build_string(html_question_box,l,_poll_make_form_safe(e),n)+"\n";var i="",a=0;for(var r in poll_choices){var s,d=r.replace(new RegExp("^"+l+"_(\\d+)$"),"$1");isNaN(d)||(s=lang_build_string(html_votes_box,l,d,poll_votes[r]),a++,i+="\n"+lang_build_string(html_choice_box,l,d,_poll_make_form_safe(poll_choices[r]),s))}a<max_poll_choices&&(i+=lang_build_string(html_add_choice,l)),""!=i&&(_+="\n"+lang_build_string(html_choice_wrap,i)+"\n"),o+=lang_build_string(html_question_wrap,_)}used_questions<max_poll_questions&&(o+=lang_build_string(html_question_wrap,html_add_question)),mainobj.innerHTML=o,poll_update_state()}function poll_write_form_to_array(){var o={},l={},_={};for(var e in poll_questions)try{o[e]=document.getElementById("question_"+e).value}catch(o){}for(var n in poll_multi)try{_[n]=document.getElementById("multi_"+n).checked?1:0}catch(o){}for(var t in poll_choices)try{l[t]=document.getElementById("choice_"+t).value}catch(o){}poll_questions=o,poll_choices=l,poll_multi=_}function poll_add_question(){var o=0;for(var l in poll_questions)l>o&&(o=parseInt(l));return o+=1,poll_write_form_to_array(),poll_questions[o]="",poll_multi[o]="",poll_draw_main_box(),!1}function poll_add_choice(o){var l=0;for(var _ in poll_choices){var e=_.replace(new RegExp("^"+o+"_(\\d+)$"),"$1");isNaN(e)||e>l&&(l=parseInt(e))}return l+=1,poll_write_form_to_array(),poll_choices[o+"_"+l]="",poll_votes[o+"_"+l]=0,poll_draw_main_box(),!1}function poll_remove_choice(o){return confirm(js_lang_confirm)&&(delete poll_choices[o],delete poll_votes[o],poll_write_form_to_array(),poll_draw_main_box()),!1}function poll_remove_question(o){if(confirm(js_lang_confirm)){for(var l in delete poll_questions[o],poll_choices){var _=l.replace(new RegExp("^"+o+"_(\\d+)$"),"$1");isNaN(_)||(delete poll_choices[l],delete poll_votes[l])}poll_write_form_to_array(),poll_draw_main_box()}return!1}function poll_update_state(){used=max_poll_questions-used_questions;var o=lang_build_string(poll_stat_lang,used,max_poll_choices);statobj.innerHTML=lang_build_string(html_stat_wrap,o)}function show_poll_form(){my_show_div(openobj),my_hide_div(closedobj)}function close_poll_form(){my_show_div(closedobj),my_hide_div(openobj)}function _poll_make_form_safe(o){return o=(o=o.replace(/'/g,"&#039;")).replace(/"/g,"&quot;")}